# ุจูุงุก ุจูุช ุฏุฑุฏุดุฉ ุจุฅุณุชุฎุฏุงู OpenAI

ูู ูุฐุง ุงูุฏุฑุณุ ุณูุจูู ุจูุช ูุญุงุฏุซุฉ ุจุณูุท ููุบุงูุฉ ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช OpenAI. ุณูุทูุจ ููุท ูู ุงููุณุชุฎุฏู ุฅุฏุฎุงู ุจูุงูุงุชุ ูุฅุฑุณุงููุง ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุชุ ูุงูุญุตูู ุนูู ุงูุงุณุชุฌุงุจุฉ ุงูุชู ูุฑุณููุง ูุฑุฉ ุฃุฎุฑู.

## ุงูุชูููุงุช

ุณูุณุชุฎุฏู ูู ูุฐุง ุงูุฏุฑุณ ุฅุทุงุฑ ุงูุนูู Nextjs ููุบุฉ TypeScript ูุฅุทุงุฑ Tailwind.

ุชุฃูุฏ ูู ุชุซุจูุช Nodejs ุจุงููุนู ุนูู ุฌูุงุฒู. ุฅุฐุง ูู ุชูู ุจุชูุฒููู ููููู ุชูุฒููู <a href="https://nodejs.org/en/download" target="_blank">ูู ููุง</a>

ุณูุณุชุฎุฏู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู Nextjsุ ูุงูุฐู ูุชุถูู ุงุณุชุฎุฏุงู ููุฌู ุงูุชุทุจููุงุช. ุฅูู ูุฎุชูู ุชูุงููุง ุนู ุงูุฅุตุฏุงุฑ ุงูุฐู ูุฏ ุชููู ูุนุชุงุฏูุง ุนููู ุญุงูููุง.

ุชุญุชุงุฌ ุฃูุถูุง ุฅูู ููุชุงุญ OpenAI API. ุฅุฐุง ูู ููู ูุฏููุ ูุฅุญุตู ุนูู ูุงุญุฏุฉ <a href="https://platform.openai.com/account/api-keys" target="_blank">ูู ููุง</a>

ูู ุจุฅุณุชุฏุนุงุก ูุดุฑูุน Nextjs ูู ุฎูุงู ุฅุถุงูุฉ ูุฐุง ูู terminal:

```bash
npx create-next-app@latest
```

ูุงูุงุณุชูุฑุงุฑ ูู ุชุชุจุน ุงูุฎุทูุงุช ูุชุซุจูุช ุงู package ูุฏ ูุทูุจูุง ููู.

ุงุณู ุงููุดุฑูุน: **chatbot**

ุชุฃูุฏ ูู ุฃู ุฅุนุฏุงุฏุงุช ูุดุฑูุนู ุชุจุฏู ุจูุฐุง ุงูุดูู:
<img src="https://www.web3arabs.com/courses/ai/chatbot/next-chatbot.png"/>

ุณูููู ุจุชุซุจูุช ููููุงุช OpenAI ูู ุงููุดุฑูุน ูู ุฎูุงู ุฅุถุงูุฉ ูุฐุง ูู terminal:

```bash
npm install openai
```

ูู ุจุชุซุจูุช ุญุฒูุฉ dotenv ุญุชู ุชุชููู ูู ุฅุณุชูุฑุงุฏ ููู **env.**

```bash
npm install dotenv
```

ุงูุงู ูู ุจุฅูุดุงุก ููู **env.** ูู ุงููุดุฑูุน ุงูุฐู ูููุง ุจุฅูุดุงุฆู ูุงุถู **secret key** ุงูุฎุงุต ุจู

```bash
OPENAI_API_KEY="sk-yoursecretkey"
```

> ููููู ุงูุญุตูู ุนูู secret key ุงูุฎุงุต ุจู <a href="https://platform.openai.com/account/api-keys" target="_blank">ูู ููุง</a>

## ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Front-end)

ุจุนุฏ ุฅู ูููุง ุจุฅุณุชุฏุนุงุก ูุดุฑูุน Nextjs ูุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุนูู ุงูุฐู ุณูุนูู ุนูููุง ุฏุนููุง ูุจุฏุก ูู ุงูุจูุงุก

ุฅุฐูุจ ุฅูู ุงูููู **src/app/globals.css** ููู ุจุฅุถุงูุฉ ูุฐุง ุงูููุฏ ุจุนุฏ ุงู ุชููู ุจุฅุฒุงูุฉ ุงูููุฏ ุงูุณุงุจู

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

ุฅุฐูุจ ุฅูู ููู **src/app/page.tsx** ููู ุจุฅุฒุงูุฉ ูู ุงูููุฏ ุงูุฐู ุณุชุฑุงู ูุงุถู ูุฐุง ุงูููุฏ ููู ุจุฅุชุจุงุน ูู ุณุทุฑ ููุง ูู ููุถุญ ูุธููุฉ ูู ุดูุก ูุชูุงุฌุฏ ูู ุงูููุฏ.

```TSX
// ูู ุงูุตูุญุฉ ููุฌุจ ุงู ูุฌุนููุง ุชูุนุฑุถ ูู ุฌุงูุจ ุงูุนููู ูููุณ ุงูุณูุฑูุฑ useState ุจูุง ุงููุง ุณูููู ุจุฅุถุงูุฉ
"use client";
import { useState } from "react";

export default function Home() {
  /**
   * ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ูู ุงููุงุฆูุงุช ููุณุงุนุฏุฉ ุฑูุจูุช ุงููุญุงุฏุซุฉ ุนูู ุชุชุจุน ูุญููุธุงุช ูุญุงุฏุซุชู ูุน ูุณุชุฎุฏู ูุนูู
   * ุณุชุชู ุฅุนุงุฏุฉ ุชุนูููู ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุญููู
   * content ู role : ูู ูุงุฆู ูู ุฎุงุตูุชุงู
   */
  const [messages, setMessages] = useState([
    {
      role: "assistant",
      content: "ูุฑุญุจุงูุ ููู ูููููุง ูุณุงุนุฏุชูุ",
    },
  ]);
  // ุงููุฏุฎูุงุช ุงูุชู ุณูุนุทููุง ุงููุณุชุฎุฏู ููุจูุช
  const [theTextarea, setTheTextarea] = useState("");
  // OpenAI ุณุชุธูุฑ ูููุณุชุฎุฏู ูุต ุงุซูุงุก ุงูุฅูุชุธุงุฑ ูุฑุฏ
  const [isLoading, setIsLoading] = useState(false);

  /**
   * OpenAI ุชููู ูุฐู ุงูุฏุงูุฉ ุจุงูุฅุชุตุงู ุจุฑุฏ
   */
  const getResponse = async () => {
    // ูุธูุฑ ูููุณุชุฎุฏู ุงูู ูุง ุฒุงู ุงูุจูุช ูููู ุจุงูุฑุฏ ูุนููู ุงูุฅูุชุธุงุฑ ุญุชู ููุชูู
    setIsLoading(true);
    // ูููุง messages ูุตูููุฉ ูุคูุชุฉ ููุถุน ุฌููุน ุนูุงุตุฑ ูุตูููุฉ
    let mess = messages;
    /**
     * ูุฏูุน ูุฏุฎูุงุช ุงููุณุชุฎุฏู ุฅูู ูุฐู ุงููุตูููุฉ ุงููุคูุชุฉ ููุถุจุท ุฑุณุงุฆููุง
     * ููุฏ ูููุง ุจูุนู ูุฐุง ูุฃูู ููุณ ูู ุงูุฌูุฏ ุฏูุน ุงูุจูุงูุงุช ุงูู ุงููุตูููุฉ ุงูุฃุณุงุณูุฉ
     * ููุฐูู ูููุง ุจุฅูุดุงุก ูุตูููุฉ ูุคูุชุฉ
     */
    mess.push({ role: "user", content: theTextarea });
    // ูููู ุจุฅุฑุฌุงุน ุฎุงูุฉ ุฅุฏุฎุงู ุงููุญุชูู ูู ุฌุงุจ ุงููุณุชุฎุฏู ูุงุฑุบุฉ
    setTheTextarea("");

    // ุงูุฎุงุต ุจูุง ุงูุฐู ูู ูููู ุจุฅูุดุงุฆู ุจุนุฏ API ูููู ุจุฅุฑุณุงู ุทูุจ ุงูู
    const response = await fetch("/api", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },

      body: JSON.stringify({ messages }),
    });

    // output ูููู ุจุทูุจ ุฅุฑุฌุงุน ุงูุจูุงูุงุช ูุงููุฎุฑุฌุงุช
    const data = await response.json();
    const { output } = data;

    // ุงูุชู ุชุญุชูู ุงูุถุงู ุนูู ุจูุงูุงุช ุงูุงุฏุฎุงู messages ูููู ุจุฅุถุงูุฉ ุจูุงูุงุช ุงูุงุฎุฑุงุฌ ุงูุชู ุงุฑุณูุช ููุง ูู ุงูุจูุช ุงูู ูุตูููุฉ
    setMessages((prevMessages) => [...prevMessages, output]);
    // ูุงูุชู ุชุนูู ุงู ุงูุจูุช ูุฏ ุงูุชูู ูู ูุชุงุจุฉ ุฑุฏู false ูููู ุจุฅุฑุฌุงุนูุง ุงูู
    setIsLoading(false);
  }

  return (
    <main dir="rtl" className="m-2">
      <div>
        <div>
          {/* messages ุฅุณุชุฏุนุงุก ุฌููุน ุงูุจูุงูุงุช ูู ูุตูููุฉ */}
          {messages.map((e) => {
            return <div key={e.content}>{e.content}</div>
          })}

          {/* ููุธูุฑ ูููุณุชุฎุฏู ุจุฃู ุงูุจูุช ูุง ุฒุงู ูููู ุจุงูุฑุฏ true ูููุชูุง isLoading ูู ุญุงู ูุงู */}
          {isLoading ? <div className="text-red-900">ุฌุงุฑู ุงูุฑุฏ...</div> : ""}
        </div>
        {
          /**
           * theTextarea ูุฅุณุชูุจุงู ุงูุจูุงูุงุช ูู ุงููุณุชุฎุฏู ูุชุฎุฒูููุง ูู ุงููุชุบูุฑtextarea ูููุง ุจุฅูุดุงุก ุฎุงูุฉ
           * ุงุซูุงุก ุงูููุฑ ุนููู getResponse ุซู ูููุง ุจุฅูุดุงุฑ ุฒุฑ ูุชุตู ุจุงูุฏุงูุฉ
           */
        }
        <div className="flex items-center mt-6">
          <textarea
            value={theTextarea}
            onChange={(event) => setTheTextarea(event.target.value)}
            className="w-72 text-black bg-gray-200 px-2 rouded"
          />
          <button
            onClick={getResponse}
            className="bg-red-800 text-white mr-5 px-6 py-3 rounded-sm"
          >
            ุฅุฑุณุงู
          </button>
        </div>
      </div>
    </main>
  );
}
```

ูู ุจุชุดุบูู ุงููุดุฑูุน ูุชุฑู ูุง ุงูุฐู ุณูุธูุฑ ุงูุงูู

```bash
npm run dev
```

ูุฐุง ูุง ุณูุธูุฑ ูู ุงุซูุงุก ุงูุฐูุงุจ ุงูู <a href="http://localhost:3000" target="_blank">localhost:3000</a>

<img src="https://www.web3arabs.com/courses/ai/chatbot/front-end.png"/>

ุณุชุฌุฏ ุฃูู ูุง ุฒุงู ูุง ูุนูู!! ูุงูุณุจุจ ุฃูู ูุชุจูู ููุง ุงูุนูู ุนูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูููุนุฏ ุฃูู ุฌุฒุก ูุฏููุง.

## ุงููุงุฌูุฉ ุงูุฎูููุฉ (Back-end)

ุฅุฐูุจ ุงูู ูุฌูุฏ **src/app** ููู ุจุฅูุดุงุก ูุฌูุฏ ุจุฅุณู **api** ููู ูุฐุง ุงููุฌูุฏ ูู ุจุฅูุดุงุก ููู ุจุฅุณู **route.ts**

ูู ุจูุณุฎ ูุฐุง ุงูููุฏ ูุฅุถุงูุชู ููุงู ููู ุจุฅุชุจุงุน ูู ุณุทุฑ ููุง ูู ููุถุญ ุงุนูู ูู ุณุทุฑ.

```TSX
import { NextResponse } from 'next/server';
import { Configuration, OpenAIApi } from 'openai';

/**
 * API ุฏูู ูุดุงูู ุณูุญุชุงุฌ ุฅูู ุชููุฆุชูุง ุจููุชุงุญ OpenAI ููุชููู ูู ุงุณุชุฎุฏุงู ุญุฒูุฉ
 * ูู ุงูุณุงุจู .env ุงูุฐู ูููุง ุจุฅุถุงูุชู ูู ููู
*/
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);

export async function POST(req: Request, res: NextResponse) {
  // req.json() ูุชุบูุฑ ูููู ุงููุงู ุจุชุฎุฒูู
  const body = await req.json()

  /**
   * OpenAI ูููู ุจุฅุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุฎุงุตุฉ ุจ
   * "gpt-3.5-turbo" ูุญุฏุฏ ุงููููุฐุฌ ููููู
   * ุนูู ุฃููุง ุงููุตูููุฉ ุงูุชู ูุฑุฑูุงูุง ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ messages ุงูุชุนุงูู ูุน ุงูุฑุณุงุฆู
   * ุจูุซุงุจุฉ ุญุงูุธุฉ ูููุญุงุฏุซุฉ messages ุชุจุฏู
   * ุจุฅุณุชุฎุฏุงู ูุฐุง ูุนุฑู ุงูุฑูุจูุช ุงูุฎุงุต ุจูุง ูุง ุญุฏุซ ูู ุงููุงุถู ูููุฏู ุฅุฌุงุจุงุช ููููุง ูุฐูู
  */
  const completion = await openai.createChatCompletion({
    model: "gpt-3.5-turbo",
    messages: body.messages,
  });
  console.log(completion.data.choices[0].message);

  // gpt-3.5-turbo ูุณุชุฎุฑุฌ ุฃูู ูุงุฆู ุฑุณุงูุฉ ูู ุฑุฏูุฏ
  const theResponse = completion.data.choices[0].message;

  // ูููู ุจุฅุนุงุฏุชูุง ุฅูู ุงููุงุฌูุฉ ุงูุงูุงููุฉ
  return NextResponse.json({ output: theResponse }, { status: 200 })
};
```

ูู ุจุชุฌุฑุจุชู ุงูุงู ุนูู <a href="http://localhost:3000" target="_blank">localhost:3000</a>

<img src="https://www.web3arabs.com/courses/ai/chatbot/chatbot.png"/>

ุนูู ุฑุงุฆุน! ุฅูู ูุนูู ุจุดูู ุฌูุฏ ๐ฅณ๐ฅณ

ููุง ูู ุงูุญุงู ุฏุงุฆููุงุ ุฅุฐุง ูุงูุช ูุฏูู ุฃู ุฃุณุฆูุฉ ุฃู ุดุนุฑุช ุจุงูุชุนุซุฑ ุฃู ุฃุฑุฏุช ููุท ุฃู ุชููู ูุฑุญุจูุงุ ููู ุจุงูุฅูุถูุงู ุนูู <a href="https://discord.gg/ykgUvqMc4Q" target="_blank">Discord</a> ูุณูููู ุฃูุซุฑ ูู ุณุนุฏุงุก ููุณุงุนุฏุชู!